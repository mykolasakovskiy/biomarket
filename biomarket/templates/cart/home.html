{% extends "base.html" %}

{% block title %}{{ meta_title|default:"Кошик — Biomarket" }}{% endblock %}

{% block content %}
  <div class="container py-5">
    <div class="row">
      <div class="col-12">
        <h1 class="display-5 mb-3">Ваш кошик</h1>
        <p class="text-muted mb-4">Перегляньте додані товари та перейдіть до оформлення замовлення.</p>
      </div>
    </div>
    {% if cart_items %}
      <div class="row g-4">
        <div class="col-lg-8">
          <div class="list-group shadow-sm">
            {% for item in cart_items %}
              <article class="list-group-item list-group-item-action py-4">
                <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3">
                  <div>
                    <h2 class="h5 mb-1">
                      <a class="text-decoration-none" href="{{ item.product.get_absolute_url }}">{{ item.product.name }}</a>
                    </h2>
                    {% if item.product.description %}
                      <p class="mb-2 text-muted small">{{ item.product.description|truncatechars:120 }}</p>
                    {% endif %}
                    <div class="d-flex flex-wrap gap-3 small text-muted">
                      <span>Кількість: <strong class="text-dark">{{ item.quantity }}</strong></span>
                      <span>Ціна за одиницю: <strong class="text-dark">{{ item.product.price|floatformat:2 }} ₴</strong></span>
                    </div>
                  </div>
                  <div class="text-md-end">
                    <div class="fw-semibold fs-5">{{ item.line_total|floatformat:2 }} ₴</div>
                    <div class="text-muted small">Разом</div>
                  </div>
                </div>
              </article>
            {% endfor %}
          </div>
        </div>
        <div class="col-lg-4">
          <aside class="card border-0 shadow-sm">
            <div class="card-body">
              <h2 class="h5 mb-3">Підсумок замовлення</h2>
              <dl class="row mb-0 small">
                <dt class="col-6 text-muted">Товарів</dt>
                <dd class="col-6 text-end text-dark">{{ cart_quantity }}</dd>
                <dt class="col-6 text-muted">Сума</dt>
                <dd class="col-6 text-end text-dark fw-semibold fs-5">{{ cart_total|floatformat:2 }} ₴</dd>
              </dl>
              <div class="d-grid gap-2 mt-4">
                <button class="btn btn-primary" type="button" disabled>Оформити замовлення</button>
                <a class="btn btn-outline-primary" href="{% url 'products:product_list' %}">Продовжити покупки</a>
              </div>
              <p class="mt-3 mb-0 small text-muted">Підтвердіть замовлення та заповніть дані доставки на наступному кроці.</p>
            </div>
          </aside>
        </div>
      </div>
    {% else %}
      <div class="row justify-content-center">
        <div class="col-lg-6">
          <div class="card border-0 shadow-sm text-center">
            <div class="card-body py-5">
              <h2 class="h4 mb-3">Ваш кошик порожній</h2>
              <p class="text-muted mb-4">Додайте улюблені товари Biomarket до кошика, щоб оформити замовлення.</p>
              <a class="btn btn-primary" href="{% url 'products:product_list' %}">Переглянути каталог</a>
            </div>
          </div>
        </div>
      </div>
    {% endif %}
  </div>
{% endblock %}
